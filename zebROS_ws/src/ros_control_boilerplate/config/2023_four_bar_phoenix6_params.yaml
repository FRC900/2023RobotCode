four_bar_controller_2023:
    type: four_bar_controller_2023/FourBarController_2023_Phoenix6

    feed_forward_map:
        - [-0.000381728051103766, 0]
        - [0.0487084993208405, 0.175953079178886]
        - [0.0987148740154339, 0.175953079178886]
        - [0.148110483828261, 0.269794721407625]
        - [0.198498586573958, 0.211143695014663]
        - [0.247894196386786, 0.304985337243402]
        - [0.298282299132483, 0.24633431085044]
        - [0.347983291386193, 0.293255131964809]
        - [0.39837139413189, 0.234604105571848]
        - [0.44799604077538, 0.293255131964809]
        - [0.498307797910856, 0.24633431085044]
        - [0.548008790164567, 0.293255131964809]
        - [0.598091510469381, 0.269794721407625]
        - [0.648097885163974, 0.269794721407625]
        - [0.698256951079009, 0.24633431085044]
        - [0.74803428894294, 0.281524926686217]
        - [0.798040663637533, 0.281524926686217]
        - [0.847436273450361, 0.363636363636364]
        - [0.897595339365395, 0.340175953079179]
        - [0.947601714059989, 0.340175953079179]
        - [0.998066162415907, 0.281524926686217]
        - [1.04791984589006, 0.304985337243402]
        - [1.09800256619487, 0.293255131964809]
        - [1.14816163210991, 0.269794721407625]
        - [1.19786262436362, 0.304985337243402]
        - [1.24817438149909, 0.258064516129032]
        - [1.29818075619369, 0.258064516129032]
        - [1.34856885893938, 0.19941348973607]
        - [1.39834619680332, 0.234604105571848]
        - [1.44873429954901, 0.175953079178886]
        - [1.49851163741294, 0.211143695014663]
        - [1.54889974015864, 0.152492668621701]
        - [1.59882976924301, 0.164222873900293]
        - [1.65120285785445, -0.175953079178886]
        - [1.70136192376949, -0.19941348973607]
        - [1.75136829846408, -0.19941348973607]

    four_bar_joint: [ 'four_bar' ]
    dynamic_reconfigure: True
    min_angle: 0.0 # for sure. this is slightly less than vertical (it's where the limit switch hits)
    max_angle: 1.8 # measured

    # don't even care about lenghts because we are using angles

    # 0.11-0.12 worked well for holding max extension
    arb_feed_forward_angle: 0.10
    straight_up_angle: 0.0

    #motion_magic_velocity: 15.0
    #motion_magic_acceleration: 8.0
    #motion_magic_jerk: 20.0
    motion_magic_velocity: 0.5
    motion_magic_acceleration: 1.0
    motion_s_curve_strength: 2.0 # Maps to v6 motion magic jerk value

    # How quickly the four bar moves down when zeroing itself
    four_bar_zeroing_percent_output: -0.10

    # If there are no negative velocity readings while zeroing
    # for this amount of time, assume the four bar is stuck
    # or has hit bottom and the limit switch is broken.  Stop
    # trying to drive down to prevent killing the motor
    four_bar_zeroing_timeout:  2.0
    four_bar:
        type: talon_controllers/TalonFXProControllerInterface 
        joint: four_bar
        close_loop_values:
            - {kP: 24.0, kI: 0.000, kD: 0.0, kV: 0.156, kS: 0.0}
        invert: clockwise_positive
        
        neutral_mode: Brake

        reverse_limit_switch_type: "NormallyOpen"
        reverse_limit_enable: True

        sensor_to_mechanism_ratio: 40.1852 # set from ty
        command_deadband: 0.01 # set to be higher

        dynamic_reconfigure: True
