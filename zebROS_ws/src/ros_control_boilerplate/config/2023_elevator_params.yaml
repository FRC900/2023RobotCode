elevator_controller_2023:
    type: elevator_controller_2023/ElevatorController_2023

    elevator_joint: [ 'elevator_leader', 'elevator_follower']
    fourbar_joint: 'four_bar'
    max_height_val: 1.2

    arb_feed_forward_high: 0.032
    arb_feed_forward_low: 0.025

    arb_feed_forward_maximum: 0.05
    arb_feed_forward_angle: 0.04
    
    motion_magic_velocity: 2.1
    motion_magic_acceleration: 11.0

    # not sure if this needs to be here and below
    motion_s_curve_strength: 8

    # How quickly the elevator moves down when zeroing itself
    elevator_zeroing_percent_output: -0.2 # TODO : tune me

    # If there are no negative velocity readings while zeroing
    # for this amount of time, assume the elevator is stuck
    # or has hit bottom and the limit switch is broken.  Stop
    # trying to drive down to prevent killing the motor
    elevator_zeroing_timeout:  2.0
    stage_2_height: 0.7213
    elevator_leader:
        type: talon_controllers/TalonControllerInterface 
        joint: elevator_leader
        close_loop_values:
            - {p: 0.25, i: 0.00000, d: 0.001, f: 0.05, i_zone: 0, closed_loop_peak_output: 1.0}
              
        sensor_phase: False 
        invert_output: True
        #conversion_factor: 0.01822
        #conversion_factor: 0.0057996
        #conversion_factor: 0.00231984
        #conversion_factor: 0.00215745
        #conversion_factor: 0.0021143

        # linear position along 
        conversion_factor: 0.00360258
        # TODO : figure out what value this should be
        # Only need one direction, to
        # prevent the elevator from running off the top
        softlimit_forward_threshold: 1.21 #1.66755
        softlimit_forward_enable: True

        voltage_compensation_enable: True
        voltage_compensation_saturation: 12
        
        # mech num = 10.82mm
        # convert to meters

        # CHECK THIS
        feedback_type: IntegratedSensor

        # TODO : bottom limit switch config
        limit_switch_local_reverse_source: "FeedbackConnector"
        limit_switch_local_reverse_normal: "NormallyOpen" # matches what was observed

        neutral_deadband: 0.001

        dynamic_reconfigure: True
        motion_s_curve_strength: 8

    elevator_follower: 
        #conversion_factor: 0.0108

        joint: elevator_follower
        sensor_phase: False 
        invert_output: False
        #feedback_type: CTRE_MagEncoder_Relative
        #conversion_factor: 0.02959

        dynamic_reconfigure: false
